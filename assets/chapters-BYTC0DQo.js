var h=(t,n,a)=>new Promise((l,f)=>{var R=e=>{try{i(a.next(e))}catch(r){f(r)}},B=e=>{try{i(a.throw(e))}catch(r){f(r)}},i=e=>e.done?l(e.value):Promise.resolve(e.value).then(R,B);i((a=a.apply(t,n)).next())});import{c as g}from"./speaker-DvggxBZ5.js";import{f as E}from"./format-CaJKwHKc.js";import{i as v,m as C}from"./index-CHUspNL6.js";const T=["大王饶命","神墓","外挂傍身的杂草","我的徒弟都是大反派","悟空传"],m="@BR@",H=/(\s|\r|\t)+/g,P=/@BR@\s*第(.{1,8})(章|回|节|集|卷|部)[^@]{0,50}@BR@/g,b="@CH@",k=/@BR@\s*第(.{1,8})(章|回|节|集|卷|部)/g,A="@CH@第$1$2",p=v("悟空传"),I=C(T),o=C([]),s=v(1);let u=[];function c(t){if(t>u.length)return;//! 段落切分
const n=u[t].split(m).filter(a=>a!=="");//! 替换当前上下文
g.splice(0,g.length,...n),s.value=t,t?document.title=o[t]:document.title=p.value,location.assign("/#/")}function M(){c(0)}function S(){o.length&&c(o.length-1)}function j(){s.value>0&&c(s.value-1)}function q(){s.value<o.length-1&&c(s.value+1)}function z(){L(p.value)}function L(t){return h(this,null,function*(){p.value=t;const n=`/${t}.txt`,l=yield(yield fetch(n)).text();d(l),c(s.value)})}function d(t){//! 预处理换行符
t=t.replace(/\n+/g,m);//! 剔除空格、软空格、制表符
t=t.replace(H," "),$(t),w(t)}function G(t){d(t),c(s.value)}function $(t){var l;const a=((l=t.match(P))!=null?l:[]).map(E);o.splice(0,o.length,...a)}function w(t){u=t.replace(k,A).split(b);//! 当前页码校正
o.length?(location.assign("/#/chapters"),s.value=1):(location.assign("/#/"),s.value=0)}export{j as a,q as b,S as c,z as d,c as e,o as f,p as g,L as h,I as i,M as l,s as p,G as r};
